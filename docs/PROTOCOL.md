## Message format

Messages are just plain JSON objects with a newline (`'\n'`) appended to differentiate between different objects:

	{
		type: 'pubmsg',
		body: 'Hello World'
	}

## General commands

### Client to server

Messages by `type`:
* **quit** - Ends session, server will close socket immediately.
    - No parameters
* **users** - Request current user list
    - No parameters
* **status** - Request server status
    - No parameters
* **password** - Request password change
    - `currnet` *(string)*: Your current password
    - `password` *(string)*: Your new password

### Server to client

Messages by `type`:
* **users** - Currently connected users.
    - `users` *(object)*: {"user1": <connection count>, "user2": <connection count>, ...}
* **status** - Request server status
    - `uptime` *(int)*: Seconds since server start
    - `users` *(int)*: Number of connected clients
* **ping**(not implemented) - Sent by server to detect dead clients
    - `time` *(int)*: Timestamp


--------------------


## Chat protocol

### Client to server

Messages by `type`:
* **pubmsg** -  Sends a message to the main lobby channel.
    - `body`*(string)*: Message text
* **privmsg** - Sends a message to the given user.
    - `body`*(string)*: Message text
    - `target`*(string)*: Target username

### Server to client

Messages by `type`:
* **user** - The first thing sent to a client upon connecting to the service. Updates clients initial user data.
    - `username`*(string)*: Client's username
* **join** - Another user has joined the server.
    - `nick`*(string)*: Name of the user that joined
* **pubmsg** - Another user sent a message to the public lobby channel.
    - `nick`*(string)*: Name of the user that sent the message
    - `body`*(string)*: Message text
* **privmsg** - Another user sent you a private message.
    - `nick`*(string)*: Name of the user that sent the message
    - `body`*(string)*: Message text
* **quit** - Another user has disconnected from the server.
    - `nick`*(string)*: Name of the user that disconnected
    - `body`*(string)*: Quit message (currently generated by the server indicating why the session was terminated)
* **error** - Sent if client's commands fail for any reason.
    - `body`*(string)*: The error message describing what went wrong


--------------------


# Bulletin board protocol

* get threads ('threads')
* create new thread ('new')
* get thread ('thread')
* post to thread ('post')
* delete my own thread ('delete')
